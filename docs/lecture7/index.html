<!doctype html>
<html lang="en" class="h-100">
  <head>
  <meta name="generator" content="Hugo 0.54.0" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://nekrut.github.io/BMMB554/css/bootstrap.min.css">
  
  
  <title>Lecture 7: Pandas 2 | BMMB554</title>
  <style>
.container {
  max-width: 800px;
}
#nav a {
  font-weight: bold;
  color: inherit;
}
#nav a.nav-link-active {
  background-color: #212529;
  color: #fff;
}
#nav-border {
  border-bottom: 1px solid #212529;
}
#main {
  margin-top: 1em;
  margin-bottom: 4em;
}
#home-jumbotron {
  background-color: inherit;
}
#footer .container {
  padding: 1em 0;
}
#footer a {
  color: inherit;
  text-decoration: underline;
}
.font-125 {
  font-size: 125%;
}
.tag-btn {
  margin-bottom: 0.3em;
}
pre {
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 16px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  background-color: transparent;
  border-radius: 0;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 4px;
}
img {
  max-width: 100%;
}
</style>

  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
  
</head>
  <body class="d-flex flex-column h-100">
    <div id="nav-border" class="container">
  <nav id="nav" class="nav justify-content-center">
  
  
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/"><i data-feather="home"></i> Home</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/post/"><i data-feather="book-open"></i> Lectures</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/tags/"><i data-feather="tag"></i> Tags</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/about/"><i data-feather="list"></i> Syllabus</a>
  
  </nav>
</div>
    <div class="container">
      <main id="main">
        

<h1>Lecture 7: Pandas 2</h1>


<i data-feather="calendar"></i> <time datetime="2019-01-30">Jan 30, 2019</time>

  <br>
  <i data-feather="tag"></i>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/python">python</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/pandas">pandas</a>
  

<br><br>


<h1 id="prep">Prep</h1>

<ul>
<li>Point your browser to <a href="http://colab.research.google.com">http://colab.research.google.com</a></li>
<li>Open notebook <code>2019/ipynb/tnseq_with_pandas2.ipynb</code> from <code>https://github.com/nekrut/BMMB554</code></li>
</ul>

<h1 id="introduction-to-pandas-part-2">Introduction to Pandas : Part 2</h1>

<hr />

<p>This tutorial is heavily based on <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html#">Pandas in 10 min</a>. The original material waas modified by adding TnSeq data as examples.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
<span style="color:#666">%</span>matplotlib inline  </code></pre></div>
<h2 id="get-datasets-to-play-with">Get datasets to play with</h2>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
wget https://nekrut.github.io/BMMB554/tnseq_untreated.txt.gz
wget https://nekrut.github.io/BMMB554/ta_gc.txt</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_file <span style="color:#666">=</span> <span style="color:#ba2121">&#39;tnseq_untreated.txt.gz&#39;</span></code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Just two choices for beginning of of gene field</span>
<span style="">!</span>gunzip <span style="color:#666">-</span>c {data_file} <span style="color:#666">|</span> cut <span style="color:#666">-</span>f <span style="color:#666">8</span> <span style="color:#666">|</span> cut <span style="color:#666">-</span>f <span style="color:#666">1</span> <span style="color:#666">-</span>d <span style="color:#ba2121">&#39;=&#39;</span> <span style="color:#666">|</span> sort <span style="color:#666">|</span> uniq <span style="color:#666">-</span>c</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">49898 .
220202 ID</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Process tnseq_untreated.txt.gz to correctly parse gene names</span>

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">os</span>
f <span style="color:#666">=</span> <span style="color:#008000">open</span>(<span style="color:#ba2121">&#39;data.txt&#39;</span>,<span style="color:#ba2121">&#39;w&#39;</span>)

<span style="color:#008000;font-weight:bold">with</span> os<span style="color:#666">.</span>popen(<span style="color:#ba2121">&#39;gunzip -c {}&#39;</span><span style="color:#666">.</span>format(data_file)) <span style="color:#008000;font-weight:bold">as</span> stream:
  <span style="color:#008000;font-weight:bold">for</span> line <span style="color:#a2f;font-weight:bold">in</span> stream:
    <span style="color:#008000;font-weight:bold">if</span> line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>startswith( <span style="color:#ba2121">&#39;.&#39;</span> ):
      f<span style="color:#666">.</span>write( <span style="color:#ba2121">&#39;{}</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>join( line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[:<span style="color:#666">7</span>] ) , <span style="color:#ba2121">&#39;intergenic&#39;</span>  ) )
    <span style="color:#008000;font-weight:bold">elif</span> line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>startswith( <span style="color:#ba2121">&#39;ID&#39;</span> ):
      f<span style="color:#666">.</span>write( <span style="color:#ba2121">&#39;{}</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>join( line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[:<span style="color:#666">7</span>] ) , line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>split(<span style="color:#ba2121">&#39;;&#39;</span>)[<span style="color:#666">0</span>][<span style="color:#666">3</span>:] ) )
f<span style="color:#666">.</span>close()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Read from the file</span>

tnseq <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_table(<span style="color:#ba2121">&#39;data.txt&#39;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121">&#39;pos&#39;</span>,<span style="color:#ba2121">&#39;blunt&#39;</span>,<span style="color:#ba2121">&#39;cap&#39;</span>,<span style="color:#ba2121">&#39;dual&#39;</span>,<span style="color:#ba2121">&#39;erm&#39;</span>,<span style="color:#ba2121">&#39;pen&#39;</span>,<span style="color:#ba2121">&#39;tuf&#39;</span>,<span style="color:#ba2121">&#39;gene&#39;</span>])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tnseq<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2400002</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2400004</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2400006</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2400009</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2400029</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Set position as index</span>

tnseq <span style="color:#666">=</span> tnseq<span style="color:#666">.</span>set_index(<span style="color:#ba2121">&#39;pos&#39;</span>)</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tnseq<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2400002</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>2400004</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>2400006</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>2400009</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>2400029</th>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Reading GC content data</span>

gc <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_table(<span style="color:#ba2121">&#39;ta_gc.txt&#39;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121">&#39;pos&#39;</span>,<span style="color:#ba2121">&#39;gc&#39;</span>])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gc<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>gc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>0.339286</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>0.354839</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>0.367647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>42</td>
      <td>0.372340</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79</td>
      <td>0.303922</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Set position as index as well</span>

gc <span style="color:#666">=</span> gc<span style="color:#666">.</span>set_index(<span style="color:#ba2121">&#39;pos&#39;</span>)</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gc<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>0.339286</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.354839</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.367647</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.372340</td>
    </tr>
    <tr>
      <th>79</th>
      <td>0.303922</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="joins-of-all-sorts">Joins of all sorts</h2>

<p><img src="http://kirillpavlov.com/images/join-types.png" alt="" /></p>

<p>Image from Kirill Pavlov <a href="http://kirillpavlov.com/blog/2016/04/23/beyond-traditional-join-with-apache-spark/">blog</a></p>

<h3 id="prepare-sample-data">Prepare sample data</h3>

<p>To make things more digestable we will create twio dataframes, <code>df1</code> and <code>df2</code>, that are small subsets of <code>tnseq</code> and <code>gc</code> tables. In making them we will make sure that thay mostly overlap but also contain a few rows with indexes not present in the other dataframe.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Let&#39;s create a small subset of tnseq data:</span>

df1 <span style="color:#666">=</span> tnseq[( tnseq[<span style="color:#ba2121">&#39;gene&#39;</span>] <span style="color:#666">!=</span> <span style="color:#ba2121">&#39;intergenic&#39;</span> ) <span style="color:#666">&amp;</span> ( tnseq[<span style="color:#ba2121">&#39;blunt&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span> ) ]<span style="color:#666">.</span>head(<span style="color:#666">10</span>)</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Create a numpy array contain index values from fd1</span>

i <span style="color:#666">=</span> np<span style="color:#666">.</span>array(df1<span style="color:#666">.</span>index[<span style="color:#666">1</span>:])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">i</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">array([2404933, 2404937, 2410079, 2410094, 2419997, 2430244, 2430254,
       2439462, 2439466])</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Append a few gc index values to i, that are not present in df1</span>

i <span style="color:#666">=</span> np<span style="color:#666">.</span>append(i,[<span style="color:#666">2410079</span>,<span style="color:#666">2405277</span>,<span style="color:#666">2405301</span>])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">i</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">array([2404933, 2404937, 2410079, 2410094, 2419997, 2430244, 2430254,
       2439462, 2439466, 2410079, 2405277, 2405301])</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># ... and a subset of gc data</span>

df2 <span style="color:#666">=</span> gc<span style="color:#666">.</span>loc[i]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># This is what we have in df1</span>

df1</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404930</th>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># ... and this is content of df2</span>
df2</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404933</th>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2405277</th>
      <td>0.303922</td>
    </tr>
    <tr>
      <th>2405301</th>
      <td>0.274510</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="inner-join">Inner join</h3>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/SQL_Join_-_07_A_Inner_Join_B.svg/220px-SQL_Join_-_07_A_Inner_Join_B.svg.png" alt="" /></p>

<p>Here <strong>A</strong> is <code>df1</code> and <strong>B</strong> is <code>df2</code>.</p>

<p>Image from <a href="https://en.wikipedia.org/wiki/Join_(SQL)">Wikipedia</a>.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df1<span style="color:#666">.</span>join(df2, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;inner&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#666">.</span>merge(df1, df2, left_index<span style="color:#666">=</span>True, right_index<span style="color:#666">=</span>True, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;inner&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="left-join">Left join</h3>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/SQL_Join_-_01_A_Left_Join_B.svg/220px-SQL_Join_-_01_A_Left_Join_B.svg.png" alt="" /></p>

<p>Here <strong>A</strong> is <code>df1</code> and <strong>B</strong> is <code>df2</code>.</p>

<p>Image from <a href="https://en.wikipedia.org/wiki/Join_(SQL)">Wikipedia</a>.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df1<span style="color:#666">.</span>join(df2, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;left&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404930</th>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#666">.</span>merge(df1, df2, left_index<span style="color:#666">=</span>True, right_index<span style="color:#666">=</span>True, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;left&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404930</th>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="right-join">Right join</h3>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/SQL_Join_-_03_A_Right_Join_B.svg/220px-SQL_Join_-_03_A_Right_Join_B.svg.png" alt="" /></p>

<p>Here <strong>A</strong> is <code>df1</code> and <strong>B</strong> is <code>df2</code>.</p>

<p>Image from <a href="https://en.wikipedia.org/wiki/Join_(SQL)">Wikipedia</a>.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df1<span style="color:#666">.</span>join(df2, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;right&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2405277</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.303922</td>
    </tr>
    <tr>
      <th>2405301</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#666">.</span>merge(df1, df2, left_index<span style="color:#666">=</span>True, right_index<span style="color:#666">=</span>True, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;right&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2405277</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.303922</td>
    </tr>
    <tr>
      <th>2405301</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="full-join">Full join</h3>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/SQL_Join_-_05b_A_Full_Join_B.svg/220px-SQL_Join_-_05b_A_Full_Join_B.svg.png" alt="" /></p>

<p>Here <strong>A</strong> is <code>df1</code> and <strong>B</strong> is <code>df2</code>.</p>

<blockquote>
<p>Image from <a href="https://en.wikipedia.org/wiki/Join_(SQL)">Wikipedia</a>.</p>
</blockquote>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df1<span style="color:#666">.</span>join(df2, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;outer&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404930</th>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2405277</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.303922</td>
    </tr>
    <tr>
      <th>2405301</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#666">.</span>merge(df1, df2, left_index<span style="color:#666">=</span>True, right_index<span style="color:#666">=</span>True, how <span style="color:#666">=</span> <span style="color:#ba2121">&#39;outer&#39;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404930</th>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2405277</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.303922</td>
    </tr>
    <tr>
      <th>2405301</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410079</th>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>2410094</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>2419997</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>2430244</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2430254</th>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2439462</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>2439466</th>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="grouping">Grouping</h2>

<hr />

<p>By group by we are referring to a process involving one or more of the following steps:</p>

<ul>
<li>Splitting the data into groups based on some criteria</li>
<li>Applying a function to each group independently</li>
<li>Combining the results into a data structure
See the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html#groupby">Grouping section</a>.</li>
</ul>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df1<span style="color:#666">.</span>groupby([<span style="color:#ba2121">&#39;gene&#39;</span>])<span style="color:#666">.</span><span style="color:#008000">sum</span>()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene2465</th>
      <td>920.0</td>
      <td>211.0</td>
      <td>332.0</td>
      <td>310.0</td>
      <td>182.0</td>
      <td>429.0</td>
    </tr>
    <tr>
      <th>gene2471</th>
      <td>387.0</td>
      <td>65.0</td>
      <td>52.0</td>
      <td>90.0</td>
      <td>38.0</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>gene2481</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>gene2491</th>
      <td>264.0</td>
      <td>173.0</td>
      <td>61.0</td>
      <td>95.0</td>
      <td>100.0</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>gene2499</th>
      <td>220.0</td>
      <td>65.0</td>
      <td>68.0</td>
      <td>149.0</td>
      <td>41.0</td>
      <td>101.0</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df1<span style="color:#666">.</span>groupby([<span style="color:#ba2121">&#39;gene&#39;</span>])<span style="color:#666">.</span><span style="color:#008000">max</span>()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene2465</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
    </tr>
    <tr>
      <th>gene2471</th>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>gene2481</th>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>gene2491</th>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>gene2499</th>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="actually-using-sql">Actually using SQL</h2>

<p>There is a great SQL-like interface for Pandas called <a href="https://github.com/yhat/pandasql"><code>pandasql</code></a>:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="">!</span>pip install <span style="color:#666">-</span>U pandasql</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">pandasql</span> <span style="color:#008000;font-weight:bold">import</span> sqldf
pysqldf <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">lambda</span> q: sqldf(q, <span style="color:#008000">globals</span>())</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic">## Aggregating</span>

pysqldf(<span style="color:#ba2121">&#34;select gene, sum(blunt) as bl from df1 group by gene&#34;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>bl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gene2465</td>
      <td>920.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gene2471</td>
      <td>387.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gene2481</td>
      <td>111.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>gene2491</td>
      <td>264.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gene2499</td>
      <td>220.0</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic">## Joining (left join)</span>

pysqldf(<span style="color:#ba2121">&#34;select * from df1 left join df2 on df1.pos = df2.pos&#34;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>pos</th>
      <th>gc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2404930</td>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2404933</td>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>2404933.0</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2404937</td>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>2404937.0</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2410079</td>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>2410079.0</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2410079</td>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>2410079.0</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2410094</td>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>2410094.0</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2419997</td>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>2419997.0</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2430244</td>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>2430244.0</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2430254</td>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>2430254.0</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2439462</td>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>2439462.0</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2439466</td>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>2439466.0</td>
      <td>0.313725</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic">## Joining (inner join)</span>

pysqldf(<span style="color:#ba2121">&#34;select * from df1 join df2 on df1.pos = df2.pos&#34;</span>)</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>pos</th>
      <th>gc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2404933</td>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
      <td>2404933</td>
      <td>0.284314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2404937</td>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
      <td>2404937</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2410079</td>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>2410079</td>
      <td>0.352941</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2410094</td>
      <td>194.0</td>
      <td>33.0</td>
      <td>26.0</td>
      <td>46.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>2410094</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2419997</td>
      <td>111.0</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>66.0</td>
      <td>gene2481</td>
      <td>2419997</td>
      <td>0.343137</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2430244</td>
      <td>136.0</td>
      <td>90.0</td>
      <td>32.0</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>47.0</td>
      <td>gene2491</td>
      <td>2430244</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2430254</td>
      <td>128.0</td>
      <td>83.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>38.0</td>
      <td>gene2491</td>
      <td>2430254</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2439462</td>
      <td>112.0</td>
      <td>35.0</td>
      <td>36.0</td>
      <td>93.0</td>
      <td>22.0</td>
      <td>56.0</td>
      <td>gene2499</td>
      <td>2439462</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2439466</td>
      <td>108.0</td>
      <td>30.0</td>
      <td>32.0</td>
      <td>56.0</td>
      <td>19.0</td>
      <td>45.0</td>
      <td>gene2499</td>
      <td>2439466</td>
      <td>0.313725</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2410079</td>
      <td>193.0</td>
      <td>32.0</td>
      <td>26.0</td>
      <td>44.0</td>
      <td>19.0</td>
      <td>47.0</td>
      <td>gene2471</td>
      <td>2410079</td>
      <td>0.352941</td>
    </tr>
  </tbody>
</table>
</div>



      </main>
    </div>
    <footer id="footer" class="mt-auto text-center text-muted">
  <div class="container">
    Nekrutenko Lab 2019 | CC-BY
  </div>
</footer>
    <script src="https://nekrut.github.io/BMMB554/js/feather.min.js"></script>
<script>
  feather.replace()
</script>


    
  

  </body>
</html>
<!doctype html>
<html lang="en" class="h-100">
  <head>
  <meta name="generator" content="Hugo 0.53" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://nekrut.github.io/BMMB554/css/bootstrap.min.css">
  
  
  <title>Lecture 6: Pandas 1 | BMMB554</title>
  <style>
.container {
  max-width: 800px;
}
#nav a {
  font-weight: bold;
  color: inherit;
}
#nav a.nav-link-active {
  background-color: #212529;
  color: #fff;
}
#nav-border {
  border-bottom: 1px solid #212529;
}
#main {
  margin-top: 1em;
  margin-bottom: 4em;
}
#home-jumbotron {
  background-color: inherit;
}
#footer .container {
  padding: 1em 0;
}
#footer a {
  color: inherit;
  text-decoration: underline;
}
.font-125 {
  font-size: 125%;
}
.tag-btn {
  margin-bottom: 0.3em;
}
pre {
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 16px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  background-color: transparent;
  border-radius: 0;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 4px;
}
img {
  max-width: 100%;
}
</style>

  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
  
</head>
  <body class="d-flex flex-column h-100">
    <div id="nav-border" class="container">
  <nav id="nav" class="nav justify-content-center">
  
  
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/"><i data-feather="home"></i> Home</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/post/"><i data-feather="book-open"></i> Lectures</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/tags/"><i data-feather="tag"></i> Tags</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/about/"><i data-feather="list"></i> Syllabus</a>
  
  </nav>
</div>
    <div class="container">
      <main id="main">
        

<h1>Lecture 6: Pandas 1</h1>


<i data-feather="calendar"></i> <time datetime="2019-01-28">Jan 28, 2019</time>

  <br>
  <i data-feather="tag"></i>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/python">python</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/pandas">pandas</a>
  

<br><br>


<h1 id="prep">Prep</h1>

<ul>
<li>Point your browser to <a href="http://colab.research.google.com">http://colab.research.google.com</a></li>
<li>Open notebook <code>2019/ipynb/tnseq_with_pandas.ipynb</code> from <code>https://github.com/nekrut/BMMB554</code></li>
</ul>

<h1 id="introduction-to-pandas-part-1">Introduction to Pandas : Part 1</h1>

<hr />

<p>This tutorial is heavily based on <a href="https://pandas.pydata.org/pandas-docs/stable/10min.html">Pandas in 10 min</a>. The original material waas modified by adding TnSeq data as examples.</p>

<h2 id="get-datasets-to-play-with">Get datasets to play with</h2>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
wget https://nekrut.github.io/BMMB554/tnseq_untreated.txt.gz
wget https://nekrut.github.io/BMMB554/ta_gc.txt</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">2019-01-28 13:53:53 (2.53 MB/s) - &#39;tnseq_untreated.txt.gz&#39; saved [2012967/2012967]

2019-01-28 13:53:56 (2.96 MB/s) - &#39;ta_gc.txt&#39; saved [7315570/7315570] </pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_file <span style="color:#666">=</span> <span style="color:#ba2121">&#39;tnseq_untreated.txt.gz&#39;</span></code></pre></div>
<p>The first dataset lists coordinates of <code>TA</code> sites and counts of reads for TnSeq constructs &lsquo;blunt&rsquo;, &lsquo;cap&rsquo;, &lsquo;dual&rsquo;, &lsquo;erm&rsquo;, &lsquo;pen&rsquo;, and &lsquo;tuf&rsquo;:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="">!</span>gunzip <span style="color:#666">-</span>c {data_file} <span style="color:#666">|</span> head</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">2400002 0.0 0.0 1.0 0.0 0.0 1.0 .
2400004 1.0 0.0 5.0 0.0 0.0 1.0 .
2400006 1.0 0.0 5.0 1.0 0.0 1.0 .
2400009 2.0 2.0 8.0 1.0 0.0 0.0 .
2400029 6.0 1.0 0.0 1.0 0.0 1.0 .
2400038 4.0 2.0 0.0 3.0 3.0 2.0 .
2400047 22.0    4.0 2.0 3.0 4.0 5.0 .
2400061 25.0    3.0 3.0 2.0 2.0 9.0 .
2400065 3.0 0.0 1.0 1.0 1.0 5.0 .
2400072 8.0 5.0 28.0    10.0    7.0 9.0 .</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Just two choices for beginning of of gene field</span>
<span style="">!</span>gunzip <span style="color:#666">-</span>c {data_file} <span style="color:#666">|</span> cut <span style="color:#666">-</span>f <span style="color:#666">8</span> <span style="color:#666">|</span> cut <span style="color:#666">-</span>f <span style="color:#666">1</span> <span style="color:#666">-</span>d <span style="color:#ba2121">&#39;=&#39;</span> <span style="color:#666">|</span> sort <span style="color:#666">|</span> uniq <span style="color:#666">-</span>c</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">49898 .
220202 ID</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Process tnseq_untreated.txt.gz to correctly parse gene names</span>

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">os</span>
f <span style="color:#666">=</span> <span style="color:#008000">open</span>(<span style="color:#ba2121">&#39;data.txt&#39;</span>,<span style="color:#ba2121">&#39;w&#39;</span>)

<span style="color:#008000;font-weight:bold">with</span> os<span style="color:#666">.</span>popen(<span style="color:#ba2121">&#39;gunzip -c {}&#39;</span><span style="color:#666">.</span>format(data_file)) <span style="color:#008000;font-weight:bold">as</span> stream:
  <span style="color:#008000;font-weight:bold">for</span> line <span style="color:#a2f;font-weight:bold">in</span> stream:
    <span style="color:#008000;font-weight:bold">if</span> line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>startswith( <span style="color:#ba2121">&#39;.&#39;</span> ):
      f<span style="color:#666">.</span>write( <span style="color:#ba2121">&#39;{}</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>join( line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[:<span style="color:#666">7</span>] ) , <span style="color:#ba2121">&#39;intergenic&#39;</span>  ) )
    <span style="color:#008000;font-weight:bold">elif</span> line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>startswith( <span style="color:#ba2121">&#39;ID&#39;</span> ):
      f<span style="color:#666">.</span>write( <span style="color:#ba2121">&#39;{}</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>join( line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[:<span style="color:#666">7</span>] ) , line<span style="color:#666">.</span>split( <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>split(<span style="color:#ba2121">&#39;;&#39;</span>)[<span style="color:#666">0</span>][<span style="color:#666">3</span>:] ) )
f<span style="color:#666">.</span>close()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="">!</span>wc <span style="color:#666">-</span>l data<span style="color:#666">.</span>txt</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">  270100 data.txt</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="">!</span>head data<span style="color:#666">.</span>txt</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">2400002 0.0 0.0 1.0 0.0 0.0 1.0 intergenic
2400004 1.0 0.0 5.0 0.0 0.0 1.0 intergenic
2400006 1.0 0.0 5.0 1.0 0.0 1.0 intergenic
2400009 2.0 2.0 8.0 1.0 0.0 0.0 intergenic
2400029 6.0 1.0 0.0 1.0 0.0 1.0 intergenic
2400038 4.0 2.0 0.0 3.0 3.0 2.0 intergenic
2400047 22.0    4.0 2.0 3.0 4.0 5.0 intergenic
2400061 25.0    3.0 3.0 2.0 2.0 9.0 intergenic
2400065 3.0 0.0 1.0 1.0 1.0 5.0 intergenic
2400072 8.0 5.0 28.0    10.0    7.0 9.0 intergenic</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="">!</span>gunzip <span style="color:#666">-</span>c {data_file} <span style="color:#666">|</span> wc <span style="color:#666">-</span>l</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">  270100</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>

tnseq <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_table(<span style="color:#ba2121">&#39;data.txt&#39;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121">&#39;pos&#39;</span>,<span style="color:#ba2121">&#39;blunt&#39;</span>,<span style="color:#ba2121">&#39;cap&#39;</span>,<span style="color:#ba2121">&#39;dual&#39;</span>,<span style="color:#ba2121">&#39;erm&#39;</span>,<span style="color:#ba2121">&#39;pen&#39;</span>,<span style="color:#ba2121">&#39;tuf&#39;</span>,<span style="color:#ba2121">&#39;gene&#39;</span>])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Let&#39;s create a small subset of this dataset</span>
df <span style="color:#666">=</span> tnseq[tnseq[<span style="color:#ba2121">&#39;blunt&#39;</span>] <span style="color:#666">&gt;</span> <span style="color:#666">200</span>]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>469</th>
      <td>2404930</td>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>470</th>
      <td>2404933</td>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>471</th>
      <td>2404937</td>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>20753</th>
      <td>511019</td>
      <td>7399.0</td>
      <td>2021.0</td>
      <td>1933.0</td>
      <td>9207.0</td>
      <td>1860.0</td>
      <td>3141.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>20754</th>
      <td>511024</td>
      <td>7390.0</td>
      <td>2017.0</td>
      <td>1925.0</td>
      <td>9168.0</td>
      <td>1857.0</td>
      <td>3130.0</td>
      <td>intergenic</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>index</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">Int64Index([   469,    470,    471,  20753,  20754,  20755,  26131,  26436,
             26437,  26438,
            ...
            245491, 245492, 245493, 252032, 252850, 252851, 254003, 255351,
            260067, 267395],
           dtype=&#39;int64&#39;, length=104)</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>describe()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.040000e+02</td>
      <td>104.000000</td>
      <td>104.000000</td>
      <td>104.000000</td>
      <td>104.000000</td>
      <td>104.000000</td>
      <td>104.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.295009e+06</td>
      <td>473.000000</td>
      <td>145.307692</td>
      <td>141.394231</td>
      <td>428.307692</td>
      <td>134.855769</td>
      <td>221.884615</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.859577e+05</td>
      <td>1200.109048</td>
      <td>328.880097</td>
      <td>319.687360</td>
      <td>1525.561454</td>
      <td>303.135217</td>
      <td>510.726083</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.068300e+04</td>
      <td>202.000000</td>
      <td>27.000000</td>
      <td>18.000000</td>
      <td>35.000000</td>
      <td>16.000000</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.110228e+05</td>
      <td>217.750000</td>
      <td>51.750000</td>
      <td>43.750000</td>
      <td>73.000000</td>
      <td>49.500000</td>
      <td>76.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.046223e+06</td>
      <td>248.000000</td>
      <td>77.000000</td>
      <td>64.500000</td>
      <td>116.500000</td>
      <td>71.500000</td>
      <td>116.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.105208e+06</td>
      <td>312.750000</td>
      <td>123.000000</td>
      <td>108.250000</td>
      <td>204.500000</td>
      <td>107.000000</td>
      <td>183.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.726151e+06</td>
      <td>7399.000000</td>
      <td>2021.000000</td>
      <td>1933.000000</td>
      <td>9207.000000</td>
      <td>1860.000000</td>
      <td>3141.000000</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#666">=</span> df<span style="color:#666">.</span>sort_values(by<span style="color:#666">=</span>[<span style="color:#ba2121">&#39;pos&#39;</span>])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#666">=</span> df<span style="color:#666">.</span>set_index(<span style="color:#ba2121">&#39;pos&#39;</span>)</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
      <td>140.0</td>
      <td>362.0</td>
      <td>128.0</td>
      <td>253.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>141343</th>
      <td>419.0</td>
      <td>185.0</td>
      <td>214.0</td>
      <td>421.0</td>
      <td>179.0</td>
      <td>380.0</td>
      <td>intergenic</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="selection">Selection</h2>

<hr />

<p><strong>Note</strong>: While standard Python / Numpy expressions for selecting and setting are intuitive and come in handy for interactive work, for production code, we recommend the optimized pandas data access methods, <code>.at</code>, <code>.iat</code>, <code>.loc</code> and <code>.iloc</code>.</p>

<p>See the indexing documentation:
 - <a href="https://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing">Indexing and Selecting Data</a>
 - <a href="https://pandas.pydata.org/pandas-docs/stable/advanced.html#advanced">MultiIndex / Advanced Indexing</a></p>

<h3 id="getting">Getting</h3>

<p>Selecting via <code>[]</code>, which slices the rows.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#666">0</span>:<span style="color:#666">3</span>]</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
    </tr>
  </tbody>
</table>
</div>

<p>Selecting a single column, a <code>series</code> can be done in two ways:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>gene<span style="color:#666">.</span>head()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">pos
40683         gene35
103869        gene90
132578       gene116
141339    intergenic
141343    intergenic
Name: gene, dtype: object</pre></div>
<p>or</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#ba2121">&#39;gene&#39;</span>]<span style="color:#666">.</span>head()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">pos
40683         gene35
103869        gene90
132578       gene116
141339    intergenic
141343    intergenic
Name: gene, dtype: object</pre></div>
<h3 id="selection-by-label">Selection by label</h3>

<p>See more in <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#indexing-label">Selection by Label</a>.</p>

<p>For getting a cross section using a label:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>loc[<span style="color:#666">2404930</span>]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">blunt         283
cap            65
dual          109
erm            94
pen            47
tuf           128
gene     gene2465
Name: 2404930, dtype: object</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>loc[<span style="color:#666">2404930</span>,[<span style="color:#ba2121">&#39;erm&#39;</span>,<span style="color:#ba2121">&#39;pen&#39;</span>]]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">erm    94
pen    47
Name: 2404930, dtype: object</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>loc[<span style="color:#666">2404930</span>:<span style="color:#666">2404937</span>,[<span style="color:#ba2121">&#39;erm&#39;</span>,<span style="color:#ba2121">&#39;pen&#39;</span>]]</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>erm</th>
      <th>pen</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2404930</th>
      <td>94.0</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>94.0</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>122.0</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="selection-by-position">Selection by position</h3>

<p>See more in <a href="https://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-integer">Selection by Position</a></p>

<p>Select via the position of the passed integers:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>iloc[<span style="color:#666">3</span>]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">blunt           348
cap             136
dual            140
erm             362
pen             128
tuf             253
gene     intergenic
Name: 141339, dtype: object</pre></div>
<p>By integer slices, acting similar to numpy/python:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>iloc[<span style="color:#666">3</span>:<span style="color:#666">5</span>,<span style="color:#666">0</span>:<span style="color:#666">2</span>]</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
    </tr>
    <tr>
      <th>141343</th>
      <td>419.0</td>
      <td>185.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>By lists of integer position locations, similar to the numpy/python style:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>iloc[[<span style="color:#666">1</span>,<span style="color:#666">2</span>,<span style="color:#666">4</span>],[<span style="color:#666">0</span>,<span style="color:#666">2</span>]]</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>dual</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>141343</th>
      <td>419.0</td>
      <td>214.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>For slicing rows explicitly:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>iloc[<span style="color:#666">100</span>:,<span style="color:#666">1</span>:<span style="color:#666">5</span>]</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2663073</th>
      <td>141.0</td>
      <td>61.0</td>
      <td>137.0</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>2703968</th>
      <td>57.0</td>
      <td>51.0</td>
      <td>70.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>2726139</th>
      <td>107.0</td>
      <td>542.0</td>
      <td>155.0</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>2726151</th>
      <td>111.0</td>
      <td>545.0</td>
      <td>156.0</td>
      <td>89.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>For getting a value explicitly:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>iloc[<span style="color:#666">1</span>,<span style="color:#666">1</span>]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">42.0</pre></div>
<p>For getting fast access to a scalar (equivalent to the prior method):</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>iat[<span style="color:#666">1</span>,<span style="color:#666">1</span>]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">42.0</pre></div>
<h3 id="selecting-based-on-condition-boolean-indexing">Selecting based on condition (boolean indexing)</h3>

<p>Using a single columnâ€™s values to select data:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[df<span style="color:#666">.</span>gene <span style="color:#666">!=</span> <span style="color:#ba2121">&#39;intergenic&#39;</span>]<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
    </tr>
    <tr>
      <th>203828</th>
      <td>287.0</td>
      <td>45.0</td>
      <td>35.0</td>
      <td>72.0</td>
      <td>84.0</td>
      <td>223.0</td>
      <td>gene172</td>
    </tr>
    <tr>
      <th>203830</th>
      <td>287.0</td>
      <td>45.0</td>
      <td>35.0</td>
      <td>73.0</td>
      <td>84.0</td>
      <td>223.0</td>
      <td>gene172</td>
    </tr>
  </tbody>
</table>
</div>

<p>Selecting values from a DataFrame where a boolean condition is met:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[df <span style="color:#666">&gt;</span> <span style="color:#666">0</span>]<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
      <td>140.0</td>
      <td>362.0</td>
      <td>128.0</td>
      <td>253.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>141343</th>
      <td>419.0</td>
      <td>185.0</td>
      <td>214.0</td>
      <td>421.0</td>
      <td>179.0</td>
      <td>380.0</td>
      <td>intergenic</td>
    </tr>
  </tbody>
</table>
</div>

<p>Using the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isin.html#pandas.Series.isin"><code>isin()</code></a> method for filtering:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>gene<span style="color:#666">.</span>unique()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">array([&#39;gene35&#39;, &#39;gene90&#39;, &#39;gene116&#39;, &#39;intergenic&#39;, &#39;gene172&#39;, &#39;gene176&#39;,
       &#39;gene206&#39;, &#39;gene233&#39;, &#39;gene275&#39;, &#39;gene297&#39;, &#39;gene313&#39;, &#39;gene443&#39;,
       &#39;gene528&#39;, &#39;gene533&#39;, &#39;gene673&#39;, &#39;gene688&#39;, &#39;gene929&#39;, &#39;gene932&#39;,
       &#39;gene1016&#39;, &#39;gene1342&#39;, &#39;gene1364&#39;, &#39;gene1469&#39;, &#39;gene1516&#39;,
       &#39;gene1751&#39;, &#39;gene1753&#39;, &#39;gene1833&#39;, &#39;gene2010&#39;, &#39;gene2134&#39;,
       &#39;gene2176&#39;, &#39;gene2195&#39;, &#39;gene2209&#39;, &#39;gene2233&#39;, &#39;gene2321&#39;,
       &#39;gene2390&#39;, &#39;gene2465&#39;, &#39;gene2664&#39;, &#39;gene2707&#39;, &#39;gene2764&#39;,
       &#39;gene2787&#39;], dtype=object)</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[df[<span style="color:#ba2121">&#39;gene&#39;</span>]<span style="color:#666">.</span>isin([<span style="color:#ba2121">&#39;gene2465&#39;</span>,<span style="color:#ba2121">&#39;gene206&#39;</span>])]</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>242376</th>
      <td>229.0</td>
      <td>31.0</td>
      <td>56.0</td>
      <td>63.0</td>
      <td>44.0</td>
      <td>69.0</td>
      <td>gene206</td>
    </tr>
    <tr>
      <th>242378</th>
      <td>204.0</td>
      <td>31.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>39.0</td>
      <td>42.0</td>
      <td>gene206</td>
    </tr>
    <tr>
      <th>2404930</th>
      <td>283.0</td>
      <td>65.0</td>
      <td>109.0</td>
      <td>94.0</td>
      <td>47.0</td>
      <td>128.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>2404933</th>
      <td>284.0</td>
      <td>67.0</td>
      <td>108.0</td>
      <td>94.0</td>
      <td>55.0</td>
      <td>128.0</td>
      <td>gene2465</td>
    </tr>
    <tr>
      <th>2404937</th>
      <td>353.0</td>
      <td>79.0</td>
      <td>115.0</td>
      <td>122.0</td>
      <td>80.0</td>
      <td>173.0</td>
      <td>gene2465</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="setting">Setting</h3>

<p>Setting a new column automatically aligns the data by the indexes:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gc <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_table(<span style="color:#ba2121">&#39;ta_gc.txt&#39;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121">&#39;pos&#39;</span>,<span style="color:#ba2121">&#39;gc&#39;</span>])</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gc <span style="color:#666">=</span> gc<span style="color:#666">.</span>set_index(<span style="color:#ba2121">&#39;pos&#39;</span>)</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gc<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>0.339286</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.354839</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.367647</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.372340</td>
    </tr>
    <tr>
      <th>79</th>
      <td>0.303922</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#ba2121">&#39;gc&#39;</span>] <span style="color:#666">=</span> gc</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
      <td>140.0</td>
      <td>362.0</td>
      <td>128.0</td>
      <td>253.0</td>
      <td>intergenic</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>141343</th>
      <td>419.0</td>
      <td>185.0</td>
      <td>214.0</td>
      <td>421.0</td>
      <td>179.0</td>
      <td>380.0</td>
      <td>intergenic</td>
      <td>0.323529</td>
    </tr>
  </tbody>
</table>
</div>

<p>Setting values by label:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>at[<span style="color:#666">2</span>,<span style="color:#ba2121">&#39;erm&#39;</span>] <span style="color:#666">=</span> <span style="color:#666">0</span></code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>loc[<span style="color:#666">2</span>]</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">blunt    NaN
cap      NaN
dual     NaN
erm        0
pen      NaN
tuf      NaN
gene     NaN
gc       NaN
Name: 2, dtype: object</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#666">=</span> df<span style="color:#666">.</span>sort_index()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
      <td>140.0</td>
      <td>362.0</td>
      <td>128.0</td>
      <td>253.0</td>
      <td>intergenic</td>
      <td>0.333333</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="missing-data">Missing data</h2>

<hr />

<p>pandas primarily uses the value <code>np.nan</code> to represent missing data. It is by default not included in computations. See the <a href="https://pandas.pydata.org/pandas-docs/stable/missing_data.html#missing-data">Missing Data section</a>.</p>

<p>To drop any rows that have missing data:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>dropna(how<span style="color:#666">=</span><span style="color:#ba2121">&#39;any&#39;</span>)<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
      <td>140.0</td>
      <td>362.0</td>
      <td>128.0</td>
      <td>253.0</td>
      <td>intergenic</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>141343</th>
      <td>419.0</td>
      <td>185.0</td>
      <td>214.0</td>
      <td>421.0</td>
      <td>179.0</td>
      <td>380.0</td>
      <td>intergenic</td>
      <td>0.323529</td>
    </tr>
  </tbody>
</table>
</div>

<p>Filling missing data</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>fillna(value<span style="color:#666">=</span><span style="color:#ba2121">&#39;0&#39;</span>)<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>40683</th>
      <td>211</td>
      <td>80</td>
      <td>91</td>
      <td>68.0</td>
      <td>81</td>
      <td>67</td>
      <td>gene35</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214</td>
      <td>42</td>
      <td>50</td>
      <td>155.0</td>
      <td>31</td>
      <td>69</td>
      <td>gene90</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202</td>
      <td>70</td>
      <td>99</td>
      <td>194.0</td>
      <td>107</td>
      <td>157</td>
      <td>gene116</td>
      <td>0.27451</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348</td>
      <td>136</td>
      <td>140</td>
      <td>362.0</td>
      <td>128</td>
      <td>253</td>
      <td>intergenic</td>
      <td>0.333333</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>isna()<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>40683</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="operations">Operations</h2>

<hr />

<p>See the <a href="https://pandas.pydata.org/pandas-docs/stable/basics.html#basics-binop">Basic section on Binary Ops</a>.</p>

<h3 id="stats">Stats</h3>

<p>Operations in general exclude missing data.</p>

<p>Performing a descriptive statistic:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>mean()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">blunt    473.000000
cap      145.307692
dual     141.394231
erm      424.228571
pen      134.855769
tuf      221.884615
gc         0.316365
dtype: float64</pre></div>
<p>Same operation on the other axis:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>mean(<span style="color:#666">1</span>)<span style="color:#666">.</span>head()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">pos
2           0.000000
40683      85.466387
103869     80.180672
132578    118.467787
141339    195.333333
dtype: float64</pre></div>
<h3 id="apply">Apply</h3>

<p>Apply functions to the data:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>gene35</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>214.0</td>
      <td>42.0</td>
      <td>50.0</td>
      <td>155.0</td>
      <td>31.0</td>
      <td>69.0</td>
      <td>gene90</td>
      <td>0.264706</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>202.0</td>
      <td>70.0</td>
      <td>99.0</td>
      <td>194.0</td>
      <td>107.0</td>
      <td>157.0</td>
      <td>gene116</td>
      <td>0.274510</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>348.0</td>
      <td>136.0</td>
      <td>140.0</td>
      <td>362.0</td>
      <td>128.0</td>
      <td>253.0</td>
      <td>intergenic</td>
      <td>0.333333</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
df<span style="color:#666">.</span>loc[:,<span style="color:#ba2121">&#39;blunt&#39;</span>:<span style="color:#ba2121">&#39;tuf&#39;</span>]<span style="color:#666">.</span><span style="color:#008000">apply</span>(np<span style="color:#666">.</span>cumsum)<span style="color:#666">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="table table-striped table-responsive">
  <thead class="thead-dark">
    <tr style="text-align: right;">
      <th></th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
    </tr>
    <tr>
      <th>pos</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>40683</th>
      <td>211.0</td>
      <td>80.0</td>
      <td>91.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>67.0</td>
    </tr>
    <tr>
      <th>103869</th>
      <td>425.0</td>
      <td>122.0</td>
      <td>141.0</td>
      <td>223.0</td>
      <td>112.0</td>
      <td>136.0</td>
    </tr>
    <tr>
      <th>132578</th>
      <td>627.0</td>
      <td>192.0</td>
      <td>240.0</td>
      <td>417.0</td>
      <td>219.0</td>
      <td>293.0</td>
    </tr>
    <tr>
      <th>141339</th>
      <td>975.0</td>
      <td>328.0</td>
      <td>380.0</td>
      <td>779.0</td>
      <td>347.0</td>
      <td>546.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="hostogramming">Hostogramming</h3>

<p>See more at <a href="https://pandas.pydata.org/pandas-docs/stable/basics.html#basics-discretization">Histogramming and Discretization</a>:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#ba2121">&#39;gene&#39;</span>]<span style="color:#666">.</span>value_counts()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">intergenic    30
gene2134       7
gene929        5
gene2010       5
gene176        4
gene1016       3
gene533        3
gene2390       3
gene172        3
gene1342       3
gene2465       3
gene1753       2
gene2233       2
gene2787       2
gene2195       2
gene206        2
gene1469       2
gene673        2
gene1833       1
gene297        1
gene116        1
gene90         1
gene2321       1
gene932        1
gene1516       1
gene313        1
gene1751       1
gene35         1
gene2764       1
gene688        1
gene2664       1
gene2707       1
gene275        1
gene233        1
gene1364       1
gene528        1
gene2176       1
gene2209       1
gene443        1
Name: gene, dtype: int64</pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#666">%</span>matplotlib inline
df<span style="color:#666">.</span>loc[:,<span style="color:#ba2121">&#39;blunt&#39;</span>:<span style="color:#ba2121">&#39;tuf&#39;</span>]<span style="color:#666">.</span>hist(bins<span style="color:#666">=</span><span style="color:#666">100</span>, sharex<span style="color:#666">=</span>True, sharey<span style="color:#666">=</span>True)</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x1230fa908&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x123146fd0&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x12317b400&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x12319f7f0&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x1231c8be0&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x1231c8c18&gt;]],
      dtype=object)</pre></div>
<p><img src="/BMMB554/img/output_77_1.png" alt="png" /></p>

<h3 id="string-methods">String Methods</h3>

<p>Series is equipped with a set of string processing methods in the str attribute that make it easy to operate on each element of the array, as in the code snippet below. Note that pattern-matching in str generally uses <a href="https://docs.python.org/3/library/re.html">regular expressions</a> by default (and in some cases always uses them). See more at <a href="https://pandas.pydata.org/pandas-docs/stable/text.html#text-string-methods">Vectorized String Methods</a>:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#ba2121">&#39;gene&#39;</span>]<span style="color:#666">.</span><span style="color:#008000">str</span><span style="color:#666">.</span>upper()<span style="color:#666">.</span>head()</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">pos
2                NaN
40683         GENE35
103869        GENE90
132578       GENE116
141339    INTERGENIC
Name: gene, dtype: object</pre></div>
<p>In the next lecture we will learn how to process data in a number of interesting ways</p>



      </main>
    </div>
    <footer id="footer" class="mt-auto text-center text-muted">
  <div class="container">
    Nekrutenko Lab 2019 | CC-BY
  </div>
</footer>
    <script src="https://nekrut.github.io/BMMB554/js/feather.min.js"></script>
<script>
  feather.replace()
</script>


    
  

  </body>
</html>